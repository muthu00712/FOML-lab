import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.model_selection import train_test_split

# ---------------------------------------------------------
# 1. Load CSV File
# ---------------------------------------------------------
df = pd.read_csv(r"C:\Users\Admin\Downloads\student_scores (2).csv")

print("Columns in your CSV:", df.columns.tolist())

# Auto-detect first two columns as X and y
X = df.iloc[:, [0]]     # Hours column
y = df.iloc[:, 1]       # Scores column

# ---------------------------------------------------------
# 2. Train-Test Split
# ---------------------------------------------------------
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# ---------------------------------------------------------
# 3. Train Linear Regression Model
# ---------------------------------------------------------
model = LinearRegression()
model.fit(X_train, y_train)

slope = model.coef_[0]
intercept = model.intercept_

print("\n=== Regression Line ===")
print(f"Score = {slope:.2f} * Hours + {intercept:.2f}")

# ---------------------------------------------------------
# 4. Predictions
# ---------------------------------------------------------

y_pred_test = model.predict(X_test)

# ---------------------------------------------------------
# 5. Evaluation: MSE + R²
# ---------------------------------------------------------

test_mse = mean_squared_error(y_test, y_pred_test)

\
test_r2 = r2_score(y_test, y_pred_test)

print("\nModel Performance:")

print(f"Test  MSE  = {test_mse:.3f}")
print(f"Test  R²   = {test_r2:.3f}")

# ---------------------------------------------------------
# 6. Scatter Plot + Regression Line
# ---------------------------------------------------------
plt.scatter(X, y, color='blue', label='Actual Data')
plt.plot(X, model.predict(X), color='red', linewidth=2, label='Regression Line')
plt.xlabel("Hours Studied")
plt.ylabel("Exam Score")
plt.title("Linear Regression: Hours vs Exam Score")
plt.legend()
plt.grid(True)
plt.show()

# ---------------------------------------------------------
# 7. Interpretation
# ---------------------------------------------------------
print("\nINTERPRETATION:")
print(f"""
• Every additional hour of study increases predicted score by ~{slope:.2f} marks.
• Train-Test split ensures unbiased evaluation.
• Lower MSE and high R² on Test set indicate good model performance.
""")
